%
% ======================================================================
\RequirePackage{docswitch}
% \flag is set by the user, through the makefile:
%    make note
%    make apj
% etc.
\setjournal{\flag}

\documentclass[\docopts]{\docclass}

% You could also define the document class directly
%\documentclass[]{emulateapj}

% Custom commands from LSST DESC, see texmf/styles/lsstdesc_macros.sty
\usepackage{lsstdesc_macros}
\usepackage{graphicx}
\graphicspath{{./}{./figures/}}
\bibliographystyle{apj}
\usepackage{subcaption}

% Add your own macros here:
    \usepackage{etoolbox}
    \usepackage{stackengine}
        \setcounter{secnumdepth}{4}



%
% ======================================================================

\begin{document}

\title{ LSST Catalog-level Realization of Gravitationally-lensed Quasars }

\maketitlepre

\begin{abstract}

The scale of the LSST dataset will be such that we should anticipate
extracting as much information out of the its catalogs as possible,
before ever turning to the pixel-level data. In this work we explore the
use of simple, low-multiplicity Gaussian mixture models for realizing
gravitational lens systems in LSST catalog space, to enable both
large-scale sample simulation and direct model inference.

\end{abstract}

% Keywords are ignored in the LSST DESC Note style:
\dockeys{methods: statistical, cosmology: gravitational lenses}

\maketitlepost

% ----------------------------------------------------------------------

\section{Introduction}
\label{sec:intro}

The Large Synoptic Survey Telescope (LSST), a wide-field survey telescope with the diameter of 8.4m, will be start running in Chile in 2020 \citep{LSST_overall}. This telescope has a 3.5 $deg$ of field of view, would cover around $\textit{deg}^2$ in the sky, and use $u$, $g$, $r$, $i$, $z$, and $y$ filters \cite{LSST_Science_Book_v2.0}. The telescope will give extensive amount of astronomical data that could be used for the study of Solar System, Extragalactic structures, near-Earth astroids, radiant radio sources, Dark Matter, and Dark Energy. 

LSST Dark Energy Science Collaboration (DESC) also anticipate to detect around 7000 strongly lensed systems that will procide useful information such as cosmological time delay or lense mass distribution \cite{DESC_overall} \citep{time_delay_overall} \cite{Twinkles}. In order to do so, finding the lensed system among the enormous set of data is crucial. However, considering the amount of the data that LSST will produce, pixel-level data searching will be really inefficient and expensive. In order to solve the problem, we propose the lens classification with catalog-level searching with machine learning techniques.

The attempt to use Machine Learning to detect lensed system is not a new idea. \citep{convolution_neural_network} suggests that morphological classification of the lensed system using the Convolutional Neural Network(CNN) would be effective. \cite{lensextractor} has developed 'lensextractor' that uses convolution neural network to train and test the software to detect the lensed system. Most of the previous attemps involved single-band image classification \citep{lensextractor} \citep{convolution_neaural_network}.

Similarly, we propose to build a software 'SL Realizer' that does catalog-level lens search to detect lensed system. The 'SL Realizer' project largely consists of two major parts: producing large-sized catalogs of lensed systems and making the software to classify objects in the catalog as lenses or non-lenses. We first calculated the synthetic magnitude of simulated OM10 lenses to use as a training data set for SL Realizer \citep{OM10}. Using the OM10 lenses as the training set and \citep{Twinkles} as our data set, we were able to achieve ..... 

\textit{To be updated after the completion of \ref{sec:sl_realizer_train} at the end of the summer}

%https://arxiv.org/pdf/1705.05857.pdf
%Going through the entire pixel data would be really costly. 

%Very short summary of problem.
%Short discussion of previous attempts to solve it.
%Short description of our new idea.

% In this Note we answer the following questions:
% \begin{itemize}
%  \item How important is ... ?
%  \item With what precision can we ... ?
%  \item What implications does ... have?
%\end{itemize}

%Note on any conventions and assumptions made throughout the paper (magnitude systems, cosmological parameters, etc).

% ----------------------------------------------------------------------

\section{Catalog Generation}
\subsection{Synthetic magnitude calculation}
\label{sssec:Synthetic}

The OM10 mock lensed quasar catalog qso\textunderscore mock.fits contains estimates of the lens galaxy i-band magnitudes, based on a simple Faber-Jackson scaling. With the lenspop library we can compute synthetic magnitudes in i, g, r, and z filters. We validated the computation by plotting the difference in redshift,  i-band magnitude, g-r magnitude, r-i magnitude, and i-z magnitude when

\begin{itemize}
  \item comparing the synthetic magnitudes of the colored OM10 lens galaxies with those of SDSS LRGs.
  \item comparing the synthetic magnitudes of colored OM10 lens galaxies with those of 56 candidate galaxy-scale lenses that were imaged as part of the Canada-France-Hawaii Telescope (CFHT) Legacy Survey.
  \item comparing the synthetic magnitudes of colored OM10 lensed quasars with those of known SDSS Quasars.
\end{itemize}

 \ref{fig:comparison} contains the summary of the validations of synthetic magnitude calculation results, and more data could be viewed  \href{https://github.com/drphilmarshall/OM10/blob/master/notebooks/Color%20Comparison.ipynb}{here}. The OM10 lenses will be our training set for SL Realizer.

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{cfht_om10.png}
        \caption{Comparing the magnitudes between OM10 lenses and CFHT lenses.}
        \label{fig:lens_sdss}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
      %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{om10_sdss.png}
        \caption{Comparing the magnitudes between OM10 lenses and CFHT lenses.}
        \label{fig:lens_cfht}
    \end{subfigure}
    ~ %add desired spacing between images, e. g. ~, \quad, \qquad, \hfill etc. 
    %(or a blank line to force the subfigure onto a new line)
    \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{quasar_sdss.png}
        \caption{Comparing the magnitudes between OM10 quasar sources and SDSS sources. The differences were from the selection effect of SDSS quasras.}
        \label{fig:quasar_sdss}
    \end{subfigure}
    \caption{Comparing OM10 data with SDSS and CFHT data set. }\label{fig:comparison}
\end{figure}

\subsection{Visualization}

Using the OM10 lenses whose magnitude was calculated in
\ref{sssec:Synthetic}, we then visualized the lensed system. Here, in this \href{https://github.com/drphilmarshall/OM10/blob/master/notebooks/Color%20Comparison.ipynb}{notebook}, we selected a lens system that has a lens ID of $48685211$ and plotted it on different observation epochs. The result can be viewed in \ref{fig:visualization}.

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.2\textwidth}
        \includegraphics[width=\textwidth]{plot-a.png}
        \caption{Visualizing the lensed system with a filter $r$ on MJD 60143.}
        \label{fig:vis_lens_a}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\textwidth}
        \includegraphics[width=\textwidth]{plot-b.png}
        \caption{Visualizing the lensed system with a filter $g$ on MJD 60501.}
        \label{fig:vis_lens_b}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\textwidth}
        \includegraphics[width=\textwidth]{plot-c.png}
        \caption{Visualizing the lensed system with a filter $z$ on MJD 60290.}
        \label{fig:vis_lens_c}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\textwidth}
        \includegraphics[width=\textwidth]{plot-d.png}
        \caption{Visualizing the lensed system with a filter $z$ on MJD 59954.}
        \label{fig:vis_lens_d}
    \end{subfigure}
    \caption{Visualizing the lensed system in different epochs.}
    \label{fig:visualization}
\end{figure}

\subsection{Mock Catalog Generation}
\label{subsection:MCG}

\subsection{Twinkles Catalog}

The twinkles project also provides the simulation of LSST data \cite{Twinkles}. This project uses LSST's \textit{PhoSim} to generate a mock output of LSST. The table \ref{table:1} contains a few samples of the Twinkles data set.
 
\begin{table}[h!]
\centering
\begin{tabular}{||c c c c c c c||} 
 \hline
 id & ra & dec & magnorm & redshift & majoraxis & minoraxis   \\ [0.5ex] 
 \hline\hline
 21393434 & 53.0524882 & -27.7029739 & 17.8301052 & 0.184 & 1.6126157 & 1.15325373 \\ 
 21393434 & 53.0524882 & -27.7029739 & 17.8301052 & 0.184 & 1.6126157 & 1.15325373 \\
 21393434 & 53.0524882 & -27.7029739 & 17.8301052 & 0.184 & 1.6126157 & 1.15325373 \\
 21393434 & 53.0524882 & -27.7029739 & 17.8301052 & 0.184 & 1.6126157 & 1.15325373 \\
 21393434 & 53.0524882 & -27.7029739 & 17.8301052 & 0.184 & 1.6126157 & 1.15325373 \\ [1ex] 
 \hline
\end{tabular}
\caption{Sample of the Twinkles lensed system data DATA IS FAKE - NOT THE DATA WE ARE GOING TO USE IN RESEARCH}
\label{table:1}
\end{table}

\label{sec:catalog_generation}

% ----------------------------------------------------------------------

\section{Training SL Realizer}
\label{sec:sl_realizer_train}

\textit{Using the simulated data from \ref{sssec:Synthetic}, this is what I am going to do during the summer! }

% ----------------------------------------------------------------------

\section{Conclusions}
\label{sec:conclusions}

Here's a summary of what we just reported.

We can draw the following well-organized and neatly-formatted conclusions:
\begin{itemize}
  \item This is important.
  \item We can measure some number with some precision.
  \item This has some implications.
\end{itemize}

Here are some parting thoughts.

% ----------------------------------------------------------------------
% GUIDELINES FROM THE NOTE TEMPLATE:
%
% \section{Introduction}
% \label{sec:intro}
%
% This is a paper and note template for the LSST DESC \citep{Overview,ScienceBook,WhitePaper}.
% You can delete all this tutorial text whenever you like.
%
% You can easily switch between various \LaTeX\xspace styles for internal notes and peer reviewed journals.
% Documents can be compiled using the provided \code{Makefile}.
% The command \code{make} with no arguments compiles \code{main.tex} using the  \code{lsstdescnote.cls} style.
% If you want to upgrade your Note into a journal article, just choose a journal name, between \code{make apj} (ApJ preprint format), \code{make apjl} (which uses the \code{emulateapj} style), \code{make prd}, \code{make prl}, and \code{make mnras}.
%
%
% % ----------------------------------------------------------------------
%
% \section{Commands}
% \label{sec:commands}
%
% There are a number of useful \LaTeX\xspace commands predefined in \code{macros.tex}.
% Notice that the section labels are prefixed with \code{sec:} to allow the use of the \verb=\secref= command to reference a section (\ie, \secref{intro}).
% Figures can be referenced with the \verb=\figref= command, which assumes that the figure label is prefixed with \code{fig:}.
% In \figref{example} we show an example figure.
% You'll notice that the actual figure file is found in the \code{figures} directory.
% However, because we have specified this directory in our \verb=\graphicspath= we do not need to explicitly specify the path to the image.
%
% The \code{macros.tex} package also contains some conventional scientific units like \angstrom, \GeV, \Msun, etc. and some editorial tools for highlighting \FIXME{issues}, \CHECK{text to be checked}, \COMMENT{comments}, and \NEW{new additions}.
%
%
% % ----------------------------------------------------------------------
%
% \section{Methods}
% \label{sec:methods}
%
% Similar to the figure before, here we have included a table of data from \code{tables/table.tex}.
% Notice that again we are able to reference \tabref{example} with the \verb=\tabref= command using the \code{tab:} prefix.
% Also notice that we haven't needed to specify the full path to the table because in the \code{Makefile} we include \code{./tables} directory in the \code{\$TEXINPUTS} environment variable.
%
% \input{table}
%
% Equations appear as follows, and can be referred to as, for example, \eqnref{example} -- just as for tables, we use the \verb=\eqnref= command using the \code{eqn:} prefix.
% \begin{equation}
%   \label{eqn:example}
%   \langle f(k) \rangle = \frac{ \sum_{t=0}^{N}f(t,k) }{N}
% \end{equation}
%
%
% % ----------------------------------------------------------------------
%
% \section{Results}
% \label{sec:results}
%
% \figref{example} shows an example figure, referred to with the \verb=\figref= command and the \code{fig:} prefix.
%
% \begin{figure}
% \includegraphics[width=0.9\columnwidth]{example.png}
% \caption{An example figure: the LSST DESC logo, copied from \code{texmf/logos/desc-logo.png} into \code{figures/example.png}. \label{fig:example}}
% \end{figure}
%
%
% % ----------------------------------------------------------------------
%
% \section{Discussion}
% \label{sec:discussion}
%
% If you are planning on committing your paper to GitHub, it's a good idea to write your tex as one sentence per line.
% This allows for an easier \code{diff} of changes.
% It also makes sense to think of latex as \emph{code}, and sentences as logical statements, occupying one line each.
% Each line must ``compile'' in the mind of the reader.
%
%
%
% ----------------------------------------------------------------------

\subsection*{Acknowledgments}

Here is where you should add your specific acknowledgments, remembering that some standard thanks will be added via the \code{acknowledgments.tex} and \code{contributions.tex} files.

\input{acknowledgments}

\input{contributions}

%{\it Facilities:} \facility{LSST}

% Include both collaboration papers and external citations:
\bibliography{lsstdesc,main}

\end{document}
% ======================================================================
%
